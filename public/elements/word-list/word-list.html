<link rel="import" href="/bower_components/polymer/polymer.html">
<link rel="import" href="/bower_components/iron-ajax/iron-ajax.html">
<link rel="import" href="/bower_components/paper-scroll-header-panel/paper-scroll-header-panel.html">
<link rel="import" href="/bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="/bower_components/iron-icons/iron-icons.html">
<link rel="import" href="/bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="/bower_components/paper-styles/color.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout.html">
<link rel="import" href="/bower_components/iron-flex-layout/iron-flex-layout-classes.html">
<!--
A comment describing this element

Example:

    <my-elem></my-elem>

Example:

    <my-elem>
      <h2>Hello my-elem</h2>
    </my-elem>

@demo demo/index.html
-->
<dom-module id="word-list">
  <template>
    <style>
    :host {
      display: block;
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
    }
    
    paper-scroll-header-panel {
      position: absolute;
      top: 0;
      right: 0;
      bottom: 0;
      left: 0;
      background-color: var(--paper-grey-200, #eee);
      /* background for toolbar when it is at its full size */
      --paper-scroll-header-panel-full-header: {
        background-image: url(images/bg1.jpg);
      }
      /* background for toolbar when it is condensed */
      --paper-scroll-header-panel-condensed-header: {
        background-image: url(images/bg4.jpg);
      }
    }
    
    paper-toolbar.tall {
      /* custom toolbar height */
      height: 256px;
      background-color: transparent;
    }
    a {
      color: white;
    }
    
    paper-toolbar.tall .title {
      margin-left: 60px;
      -webkit-transform-origin: left center;
      transform-origin: left center;
    }
    
    .subtitle {
      color: gray;
      font-size: 0.8em;
    }
    
    paper-icon-button {
      --paper-icon-button-ink-color: white;
    }
    
    .content {
      padding: 8px;
    }
    
    .spacer {
      @apply(--layout-flex);
    }
    
    .demo-block {
      height: 200px;
    }
    </style>
    <carbon-route route="{{route}}" pattern="/:id" data="{{data}}" tail="{{tail}}"></carbon-route>
    <iron-ajax auto url="api/words/{{data.id}}" handle-as="json" last-response="{{lastResponse}}"></iron-ajax>
    <paper-scroll-header-panel condenses header-height="256" condensed-header-height="64">
      <paper-toolbar class="tall">
        <a href="#/lessons">
          <paper-icon-button icon="arrow-back"></paper-icon-button>
        </a>
        <div class="spacer"></div>
        <paper-icon-button icon="social:school"></paper-icon-button>
        <div class="bottom bottom-text title" id="word-list-title">
          <div>{{_getTitle(lastResponse.lesson)}}</div>
          <div class="subtitle">学习进度35/55</div>
        </div>
      </paper-toolbar>
      <div class="content layout vertical">
        <template is="dom-repeat" items={{lastResponse.words}} as="item" index-as="index">
          <!-- {{"item"}} and {{"index"}} can be used in this binding scope -->
          <paper-material flex elevation="1" class="demo-block">
            {{item.kanji}}
          </paper-material>
        </template>
      </div>
    </paper-scroll-header-panel>
  </template>
  <script>
  Polymer({
    is: 'word-list',
    properties: {
      array: {
        type: Array,
        value: ['1', '1', '1', '1', '1', '1', '1', '1', '1']
      }
    },
    listeners: {
      'paper-header-transform': 'header-transform'
    },
    _getTitle: (lesson)=>{
      if(lesson) {
        return `${lesson.book} ${lesson.chapter}单元 第${lesson.lesson}课`;
      }
    },
    'header-transform': (e) => {
      var d = e.detail;
      var m = d.height - d.condensedHeight;
      var scale = Math.max(0.75, (m - d.y) / (m / 0.25) + 0.75);
      var title = document.querySelector('#word-list-title');

      Polymer.Base.transform('scale(' + scale + ') translateZ(0)', title);
    }
  });
  </script>
</dom-module>
